{"ast":null,"code":"/**\n * stego.js\n * Temporal steganography using per-frame blue-channel LSB encoding\n * Binary payload version\n */\n\n/* =========================\n   PUBLIC API\n========================= */\n\n/**\n * Encode a binary string into GIF frames\n * @param {Array} gifFrames - gifuct-js frames\n * @param {string} binaryPayload - \"010101...\"\n * @param {string} key - encryption key (optional)\n * @returns {Array} modified frames\n */\nexport function encodeGIF(gifFrames, binaryPayload, key = \"\") {\n  if (!(gifFrames !== null && gifFrames !== void 0 && gifFrames.length)) throw new Error(\"No GIF frames provided\");\n\n  // Optional encryption (on binary)\n  const payload = key ? xorBinary(binaryPayload, key) : binaryPayload;\n\n  // Add 32-bit length header\n  const lengthHeader = payload.length.toString(2).padStart(32, \"0\");\n  const fullPayload = lengthHeader + payload;\n  let bitIndex = 0;\n  for (const frame of gifFrames) {\n    const data = frame.patch;\n    for (let i = 0; i < data.length; i += 4) {\n      if (bitIndex >= fullPayload.length) return gifFrames;\n\n      // Blue channel = index + 2\n      data[i + 2] = data[i + 2] & ~1 | Number(fullPayload[bitIndex]);\n      bitIndex++;\n    }\n  }\n  if (bitIndex < fullPayload.length) {\n    console.warn(\"Payload truncated: GIF too small\");\n  }\n  return gifFrames;\n}\n\n/**\n * Decode binary payload from GIF frames\n * @param {Array} gifFrames\n * @param {string} key - encryption key (optional)\n * @returns {string} decoded binary string\n */\nexport function decodeGIF(gifFrames, key = \"\") {\n  if (!(gifFrames !== null && gifFrames !== void 0 && gifFrames.length)) throw new Error(\"No GIF frames provided\");\n  let bits = \"\";\n  for (const frame of gifFrames) {\n    const data = frame.patch;\n    for (let i = 0; i < data.length; i += 4) {\n      bits += (data[i + 2] & 1).toString();\n    }\n  }\n\n  // Read first 32 bits = payload length\n  const payloadLength = parseInt(bits.slice(0, 32), 2);\n  let payload = bits.slice(32, 32 + payloadLength);\n\n  // Optional decryption\n  if (key) {\n    payload = xorBinary(payload, key);\n  }\n  return payload;\n}\n\n/* =========================\n   HELPERS\n========================= */\n\n/**\n * XOR encryption on binary string\n */\nfunction xorBinary(binary, key) {\n  const keyBinary = stringToBinary(key);\n  let result = \"\";\n  for (let i = 0; i < binary.length; i++) {\n    const bit = binary[i] ^ keyBinary[i % keyBinary.length];\n    result += bit;\n  }\n  return result;\n}\n\n/**\n * Convert string to binary\n */\nfunction stringToBinary(str) {\n  return Array.from(str).map(c => c.charCodeAt(0).toString(2).padStart(8, \"0\")).join(\"\");\n}","map":{"version":3,"names":["encodeGIF","gifFrames","binaryPayload","key","length","Error","payload","xorBinary","lengthHeader","toString","padStart","fullPayload","bitIndex","frame","data","patch","i","Number","console","warn","decodeGIF","bits","payloadLength","parseInt","slice","binary","keyBinary","stringToBinary","result","bit","str","Array","from","map","c","charCodeAt","join"],"sources":["/Users/melvinescobar/Steganography/src/components/stego.js"],"sourcesContent":["/**\n * stego.js\n * Temporal steganography using per-frame blue-channel LSB encoding\n * Binary payload version\n */\n\n/* =========================\n   PUBLIC API\n========================= */\n\n/**\n * Encode a binary string into GIF frames\n * @param {Array} gifFrames - gifuct-js frames\n * @param {string} binaryPayload - \"010101...\"\n * @param {string} key - encryption key (optional)\n * @returns {Array} modified frames\n */\nexport function encodeGIF(gifFrames, binaryPayload, key = \"\") {\n  if (!gifFrames?.length) throw new Error(\"No GIF frames provided\");\n\n  // Optional encryption (on binary)\n  const payload = key\n    ? xorBinary(binaryPayload, key)\n    : binaryPayload;\n\n  // Add 32-bit length header\n  const lengthHeader = payload.length\n    .toString(2)\n    .padStart(32, \"0\");\n\n  const fullPayload = lengthHeader + payload;\n\n  let bitIndex = 0;\n\n  for (const frame of gifFrames) {\n    const data = frame.patch;\n\n    for (let i = 0; i < data.length; i += 4) {\n      if (bitIndex >= fullPayload.length) return gifFrames;\n\n      // Blue channel = index + 2\n      data[i + 2] = (data[i + 2] & ~1) | Number(fullPayload[bitIndex]);\n      bitIndex++;\n    }\n  }\n\n  if (bitIndex < fullPayload.length) {\n    console.warn(\"Payload truncated: GIF too small\");\n  }\n\n  return gifFrames;\n}\n\n/**\n * Decode binary payload from GIF frames\n * @param {Array} gifFrames\n * @param {string} key - encryption key (optional)\n * @returns {string} decoded binary string\n */\nexport function decodeGIF(gifFrames, key = \"\") {\n  if (!gifFrames?.length) throw new Error(\"No GIF frames provided\");\n\n  let bits = \"\";\n\n  for (const frame of gifFrames) {\n    const data = frame.patch;\n\n    for (let i = 0; i < data.length; i += 4) {\n      bits += (data[i + 2] & 1).toString();\n    }\n  }\n\n  // Read first 32 bits = payload length\n  const payloadLength = parseInt(bits.slice(0, 32), 2);\n  let payload = bits.slice(32, 32 + payloadLength);\n\n  // Optional decryption\n  if (key) {\n    payload = xorBinary(payload, key);\n  }\n\n  return payload;\n}\n\n/* =========================\n   HELPERS\n========================= */\n\n/**\n * XOR encryption on binary string\n */\nfunction xorBinary(binary, key) {\n  const keyBinary = stringToBinary(key);\n  let result = \"\";\n\n  for (let i = 0; i < binary.length; i++) {\n    const bit =\n      binary[i] ^ keyBinary[i % keyBinary.length];\n    result += bit;\n  }\n\n  return result;\n}\n\n/**\n * Convert string to binary\n */\nfunction stringToBinary(str) {\n  return Array.from(str)\n    .map(c => c.charCodeAt(0).toString(2).padStart(8, \"0\"))\n    .join(\"\");\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}