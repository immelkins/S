{"ast":null,"code":"//Decryption.js\nimport{useState}from\"react\";import ToBits from\"./ToBits\";import Hamming from\"hamming-code\";import\"../stylesheets/Upload.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const HEADER_BITS=[1,0,1,0,1,0,1,1];function bitArrayToUint8Array(bits){const bytes=[];for(let i=0;i<bits.length;i+=8){let byte=0;for(let j=0;j<8;j++){byte=byte<<1|(bits[i+j]||0);}bytes.push(byte);}return new Uint8Array(bytes);}function bitArrayToString(bits){return new TextDecoder(\"utf-8\").decode(bitArrayToUint8Array(bits));}// Extract all bits from GIF frames LSB of blue channel\nfunction extractAllBitsFromFrames(frames){const allBits=[];for(const frame of frames){const patch=frame.patch;for(let i=0;i<patch.length;i+=4){allBits.push(patch[i+2]&1);}}// Check header\nfor(let i=0;i<HEADER_BITS.length;i++){if(allBits[i]!==HEADER_BITS[i]){throw new Error(\"Header not found. Possibly not encrypted or corrupt.\");}}return allBits;}export default function Decryption(){const[gifFile,setGifFile]=useState(null);const[frames,setFrames]=useState([]);const[error,setError]=useState(null);const handleGIFChange=e=>{const file=e.target.files[0];if(!file)return;setGifFile(file);ToBits(file).then(_ref=>{let{frames}=_ref;return setFrames(frames);}).catch(err=>setError(err.message));};const handleDownloadMessage=()=>{if(!frames.length)return;try{const allBits=extractAllBitsFromFrames(frames);// Extract metadata length\nconst metadataLengthBits=allBits.slice(HEADER_BITS.length,HEADER_BITS.length+32);const metadataLength=parseInt(metadataLengthBits.join(\"\"),2);const metadataEndIndex=HEADER_BITS.length+32+metadataLength;// Extract message length\nconst messageLengthBits=allBits.slice(metadataEndIndex,metadataEndIndex+32);const messageLength=parseInt(messageLengthBits.join(\"\"),2);const messageStartIndex=metadataEndIndex+32;const messageEndIndex=messageStartIndex+messageLength;// Extract message bits\nconst messageBits=allBits.slice(messageStartIndex,messageEndIndex);// Hamming ECC decode\nconst messageBitString=messageBits.join(\"\");// Convert array to string\nconst correctedBitString=Hamming.decode(messageBitString);// Decode ECC\nconst correctedBits=correctedBitString.split(\"\").map(b=>parseInt(b,10));// Convert corrected bits to text\nconst messageText=bitArrayToString(correctedBits);// Download message text\nconst blobText=new Blob([messageText],{type:\"text/plain\"});const aText=document.createElement(\"a\");aText.href=URL.createObjectURL(blobText);aText.download=\"gif_message.txt\";aText.click();console.log(\"Message downloaded successfully.\");}catch(err){setError(err.message);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Decrypt GIF Binary Data\"}),/*#__PURE__*/_jsx(\"div\",{className:\"upload-section\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"file-upload\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/gif\",onChange:handleGIFChange,hidden:true}),/*#__PURE__*/_jsx(\"span\",{className:\"file-button\",children:\"Choose GIF\"}),/*#__PURE__*/_jsx(\"span\",{className:\"file-name\",children:gifFile?gifFile.name:\"No file chosen\"})]})}),gifFile&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Uploaded GIF: \",gifFile.name]}),frames.length>0&&/*#__PURE__*/_jsx(\"button\",{className:\"file-button\",onClick:handleDownloadMessage,children:\" Download Message \"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:error})]});}","map":{"version":3,"names":["useState","ToBits","Hamming","jsx","_jsx","jsxs","_jsxs","HEADER_BITS","bitArrayToUint8Array","bits","bytes","i","length","byte","j","push","Uint8Array","bitArrayToString","TextDecoder","decode","extractAllBitsFromFrames","frames","allBits","frame","patch","Error","Decryption","gifFile","setGifFile","setFrames","error","setError","handleGIFChange","e","file","target","files","then","_ref","catch","err","message","handleDownloadMessage","metadataLengthBits","slice","metadataLength","parseInt","join","metadataEndIndex","messageLengthBits","messageLength","messageStartIndex","messageEndIndex","messageBits","messageBitString","correctedBitString","correctedBits","split","map","b","messageText","blobText","Blob","type","aText","document","createElement","href","URL","createObjectURL","download","click","console","log","children","className","accept","onChange","hidden","name","onClick"],"sources":["C:/Users/mesco/OneDrive/Documents/GitHub/S/src/components/Decryption.js"],"sourcesContent":["//Decryption.js\r\nimport { useState } from \"react\";\r\nimport ToBits from \"./ToBits\";\r\nimport Hamming from \"hamming-code\";\r\nimport \"../stylesheets/Upload.css\";\r\n\r\nconst HEADER_BITS = [1, 0, 1, 0, 1, 0, 1, 1];\r\n\r\nfunction bitArrayToUint8Array(bits) {\r\n\tconst bytes = [];\r\n\tfor (let i = 0; i < bits.length; i += 8) {\r\n\t\tlet byte = 0;\r\n\t\tfor (let j = 0; j < 8; j++) { byte = (byte << 1) | (bits[i + j] || 0); }\r\n\t\tbytes.push(byte);\r\n\t}\r\n\treturn new Uint8Array(bytes);\r\n}\r\n\r\nfunction bitArrayToString(bits) {\r\n\treturn new TextDecoder(\"utf-8\").decode(bitArrayToUint8Array(bits));\r\n}\r\n\r\n// Extract all bits from GIF frames LSB of blue channel\r\nfunction extractAllBitsFromFrames(frames) {\r\n\tconst allBits = [];\r\n\tfor (const frame of frames) {\r\n\t\tconst patch = frame.patch;\r\n\t\tfor (let i = 0; i < patch.length; i += 4) { allBits.push(patch[i + 2] & 1); }\r\n\t}\r\n\r\n\t// Check header\r\n\tfor (let i = 0; i < HEADER_BITS.length; i++) {\r\n\t\tif (allBits[i] !== HEADER_BITS[i]) {\r\n\t\t\tthrow new Error(\"Header not found. Possibly not encrypted or corrupt.\");\r\n\t\t}\r\n\t}\r\n\treturn allBits;\r\n}\r\n\r\nexport default function Decryption() {\r\n\tconst [gifFile, setGifFile] = useState(null);\r\n\tconst [frames, setFrames] = useState([]);\r\n\tconst [error, setError] = useState(null);\r\n\r\n\tconst handleGIFChange = (e) => {\r\n\t\tconst file = e.target.files[0];\r\n\t\tif (!file) return;\r\n\t\tsetGifFile(file);\r\n\r\n\t\tToBits(file)\r\n\t\t\t.then(({ frames }) => setFrames(frames))\r\n\t\t\t.catch((err) => setError(err.message));\r\n\t};\r\n\r\n\tconst handleDownloadMessage = () => {\r\n\t\tif (!frames.length) return;\r\n\r\n\t\ttry {\r\n\t\t\tconst allBits = extractAllBitsFromFrames(frames);\r\n\r\n\t\t\t// Extract metadata length\r\n\t\t\tconst metadataLengthBits = allBits.slice(HEADER_BITS.length, HEADER_BITS.length + 32);\r\n\t\t\tconst metadataLength = parseInt(metadataLengthBits.join(\"\"), 2);\r\n\t\t\tconst metadataEndIndex = HEADER_BITS.length + 32 + metadataLength;\r\n\r\n\t\t\t// Extract message length\r\n\t\t\tconst messageLengthBits = allBits.slice(metadataEndIndex, metadataEndIndex + 32);\r\n\t\t\tconst messageLength = parseInt(messageLengthBits.join(\"\"), 2);\r\n\t\t\tconst messageStartIndex = metadataEndIndex + 32;\r\n\t\t\tconst messageEndIndex = messageStartIndex + messageLength;\r\n\r\n\t\t\t// Extract message bits\r\n\t\t\tconst messageBits = allBits.slice(messageStartIndex, messageEndIndex);\r\n\r\n\t\t\t// Hamming ECC decode\r\n\t\t\tconst messageBitString = messageBits.join(\"\");               // Convert array to string\r\n\t\t\tconst correctedBitString = Hamming.decode(messageBitString); // Decode ECC\r\n\t\t\tconst correctedBits = correctedBitString.split(\"\").map(b => parseInt(b, 10));\r\n\r\n\t\t\t// Convert corrected bits to text\r\n\t\t\tconst messageText = bitArrayToString(correctedBits);\r\n\r\n\t\t\t// Download message text\r\n\t\t\tconst blobText = new Blob([messageText], { type: \"text/plain\" });\r\n\t\t\tconst aText = document.createElement(\"a\");\r\n\t\t\taText.href = URL.createObjectURL(blobText);\r\n\t\t\taText.download = \"gif_message.txt\";\r\n\t\t\taText.click();\r\n\r\n\t\t\tconsole.log(\"Message downloaded successfully.\");\r\n\t\t} catch (err) {\r\n\t\t\tsetError(err.message);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<h2>Decrypt GIF Binary Data</h2>\r\n\t\t\t<div className=\"upload-section\">\r\n\t\t\t\t<label className=\"file-upload\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\taccept=\"image/gif\"\r\n\t\t\t\t\t\tonChange={handleGIFChange}\r\n\t\t\t\t\t\thidden\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<span className=\"file-button\">Choose GIF</span>\r\n\t\t\t\t\t<span className=\"file-name\">\r\n\t\t\t\t\t\t{gifFile ? gifFile.name : \"No file chosen\"}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t\t{gifFile && <p>Uploaded GIF: {gifFile.name}</p>}\r\n\t\t\t{frames.length > 0 && (<button className=\"file-button\" onClick={handleDownloadMessage}> Download Message </button>)}\r\n\t\t\t{error && <p className=\"error\">{error}</p>}\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}