{"ast":null,"code":"// ToBinary.js\nimport Hamming from\"hamming-code\";// make sure to npm install hamming-code\nfunction uint8ArrayToBitArray(bytes){const bits=[];for(const byte of bytes){for(let i=7;i>=0;i--){bits.push(byte>>i&1);}}return bits;}function stringToBitArray(str){const bits=[];for(let i=0;i<str.length;i++){const byte=str.charCodeAt(i);for(let j=7;j>=0;j--){bits.push(byte>>j&1);}}return bits;}function numberTo32BitArray(num){const bits=[];for(let i=31;i>=0;i--){bits.push(num>>i&1);}return bits;}export default async function ToBinary(file){if(!file)throw new Error(\"No file provided\");const arrayBuffer=await file.arrayBuffer();const bytes=new Uint8Array(arrayBuffer);// Convert raw bytes to bits and encode messageBits with Hamming ECC\nlet messageBits=uint8ArrayToBitArray(bytes);const messageBitString=messageBits.join(\"\");// Convert array to string\nconst encodedBitString=Hamming.encode(messageBitString);// Hamming encode\nmessageBits=encodedBitString.split(\"\").map(b=>parseInt(b,10));// Back to array\n// Add 32-bit length for message\nconst lengthMessageBits=numberTo32BitArray(messageBits.length);const messageLoadBits=[...lengthMessageBits,...messageBits];// Create metadata object\nconst metadata={originalLength:bytes.length,fileName:file.name,fileType:file.type,messageBitsLength:messageBits.length};// Convert metadata to bits\nconst metadataStr=JSON.stringify(metadata);const metadataBits=stringToBitArray(metadataStr);// Add 32-bit metadata length prefix\nconst lengthMetaBits=numberTo32BitArray(metadataBits.length);const fullMetadataBits=[...lengthMetaBits,...metadataBits];return{bits:messageLoadBits,metabits:fullMetadataBits};}","map":{"version":3,"names":["Hamming","uint8ArrayToBitArray","bytes","bits","byte","i","push","stringToBitArray","str","length","charCodeAt","j","numberTo32BitArray","num","ToBinary","file","Error","arrayBuffer","Uint8Array","messageBits","messageBitString","join","encodedBitString","encode","split","map","b","parseInt","lengthMessageBits","messageLoadBits","metadata","originalLength","fileName","name","fileType","type","messageBitsLength","metadataStr","JSON","stringify","metadataBits","lengthMetaBits","fullMetadataBits","metabits"],"sources":["C:/Users/mesco/OneDrive/Documents/GitHub/S/src/components/ToBinary.js"],"sourcesContent":["// ToBinary.js\r\nimport Hamming from \"hamming-code\"; // make sure to npm install hamming-code\r\n\r\nfunction uint8ArrayToBitArray(bytes) {\r\n  const bits = [];\r\n  for (const byte of bytes) {\r\n    for (let i = 7; i >= 0; i--) \r\n      { bits.push((byte >> i) & 1); }\r\n  }\r\n  return bits;\r\n}\r\n\r\nfunction stringToBitArray(str) {\r\n  const bits = [];\r\n  for (let i = 0; i < str.length; i++) {\r\n    const byte = str.charCodeAt(i);\r\n    for (let j = 7; j >= 0; j--) \r\n      { bits.push((byte >> j) & 1); }\r\n  }\r\n  return bits;\r\n}\r\n\r\nfunction numberTo32BitArray(num) {\r\n  const bits = [];\r\n  for (let i = 31; i >= 0; i--) \r\n    { bits.push((num >> i) & 1); }\r\n  return bits;\r\n}\r\n\r\nexport default async function ToBinary(file) {\r\n  if (!file) throw new Error(\"No file provided\");\r\n  const arrayBuffer = await file.arrayBuffer();\r\n  const bytes = new Uint8Array(arrayBuffer);\r\n\r\n  // Convert raw bytes to bits and encode messageBits with Hamming ECC\r\n  let messageBits = uint8ArrayToBitArray(bytes);\r\n  const messageBitString = messageBits.join(\"\");                      // Convert array to string\r\n  const encodedBitString = Hamming.encode(messageBitString);          // Hamming encode\r\n  messageBits = encodedBitString.split(\"\").map(b => parseInt(b, 10)); // Back to array\r\n\r\n  // Add 32-bit length for message\r\n  const lengthMessageBits = numberTo32BitArray(messageBits.length);\r\n  const messageLoadBits = [...lengthMessageBits, ...messageBits];\r\n\r\n  // Create metadata object\r\n  const metadata = {\r\n    originalLength: bytes.length,\r\n    fileName: file.name,\r\n    fileType: file.type,\r\n    messageBitsLength: messageBits.length, \r\n  };\r\n\r\n  // Convert metadata to bits\r\n  const metadataStr = JSON.stringify(metadata);\r\n  const metadataBits = stringToBitArray(metadataStr);\r\n\r\n  // Add 32-bit metadata length prefix\r\n  const lengthMetaBits = numberTo32BitArray(metadataBits.length);\r\n  const fullMetadataBits = [...lengthMetaBits, ...metadataBits];\r\n\r\n  return { bits: messageLoadBits, metabits: fullMetadataBits };\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}