{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mesco\\\\OneDrive\\\\Documents\\\\GitHub\\\\S\\\\src\\\\components\\\\DecryptSection.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport ToBits from \"./ToBits\";\nimport { decryptData } from \"./ToBlackBox\";\n\n// Decode message (spatial) from frames\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst decodeSpatial = (frames, messageLength) => {\n  let bits = '';\n  let count = 0;\n  for (const frame of frames) {\n    const patch = frame.patch;\n    for (let i = 4; i < patch.length; i += 4) {\n      // skip first pixel to avoid temporal\n      if (count >= messageLength) break;\n      bits += (patch[i + 2] & 1).toString(); // blue channel\n      count++;\n    }\n    if (count >= messageLength) break;\n  }\n  return bits;\n};\n\n// Decode metadata (temporal) from frames\nconst decodeTemporal = (frames, metadataLength) => {\n  let bits = '';\n  for (let i = 0; i < metadataLength; i++) {\n    const frame = frames[i % frames.length]; // loop if needed\n    bits += (frame.patch[2] & 1).toString(); // first pixel blue channel\n  }\n  return bits;\n};\n\n// Convert binary string to string\nconst binaryToString = binaryStr => {\n  let result = '';\n  for (let i = 0; i < binaryStr.length; i += 8) {\n    result += String.fromCharCode(parseInt(binaryStr.slice(i, i + 8), 2));\n  }\n  return result;\n};\nexport default function DecryptSection({\n  messageLength,\n  metadataLength,\n  password\n}) {\n  _s();\n  const [frames, setFrames] = useState([]);\n  const [file, setFile] = useState(null);\n  const [fileName, setFileName] = useState('');\n  const [error, setError] = useState(null);\n  const [decryptedBlob, setDecryptedBlob] = useState(null);\n  const handleGIFChange = event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    if (file.type !== 'image/gif') {\n      setError('Please upload a valid GIF file.');\n      return;\n    }\n    setError(null);\n    setFile(file);\n    setFileName(file.name);\n  };\n  useEffect(() => {\n    if (!file || !password) return;\n    ToBits(file).then(async ({\n      frames: extractedFrames\n    }) => {\n      setFrames(extractedFrames);\n\n      // Decode metadata\n      const metadataBits = decodeTemporal(extractedFrames, metadataLength);\n      const metadataStr = binaryToString(metadataBits);\n      const metadata = JSON.parse(metadataStr);\n\n      // Decode message\n      const messageBits = decodeSpatial(extractedFrames, metadata.originalLength);\n\n      // Decrypt message\n      const encryptedData = new Uint8Array(messageBits.match(/.{1,8}/g).map(byte => parseInt(byte, 2)));\n      const decryptedBinary = await decryptData(encryptedData, password, metadata.iv, metadata.salt);\n\n      // Convert decrypted binary to Blob\n      const bytes = new Uint8Array(decryptedBinary.match(/.{1,8}/g).map(byte => parseInt(byte, 2)));\n      setDecryptedBlob(new Blob([bytes], {\n        type: metadata.fileType,\n        name: metadata.fileName\n      }));\n    }).catch(err => setError(err.message));\n  }, [file, password, metadataLength]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      accept: \"image/gif\",\n      onChange: handleGIFChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this), fileName && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Uploaded GIF: \", fileName]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 20\n    }, this), decryptedBlob && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Decrypted File\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n        href: URL.createObjectURL(decryptedBlob),\n        download: decryptedBlob.name,\n        children: [\"Download \", decryptedBlob.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 5\n  }, this);\n}\n_s(DecryptSection, \"Yy+y+pos35OmGawLsrTKVxXU6Qg=\");\n_c = DecryptSection;\nvar _c;\n$RefreshReg$(_c, \"DecryptSection\");","map":{"version":3,"names":["useEffect","useState","ToBits","decryptData","jsxDEV","_jsxDEV","decodeSpatial","frames","messageLength","bits","count","frame","patch","i","length","toString","decodeTemporal","metadataLength","binaryToString","binaryStr","result","String","fromCharCode","parseInt","slice","DecryptSection","password","_s","setFrames","file","setFile","fileName","setFileName","error","setError","decryptedBlob","setDecryptedBlob","handleGIFChange","event","target","files","type","name","then","extractedFrames","metadataBits","metadataStr","metadata","JSON","parse","messageBits","originalLength","encryptedData","Uint8Array","match","map","byte","decryptedBinary","iv","salt","bytes","Blob","fileType","catch","err","message","children","accept","onChange","_jsxFileName","lineNumber","columnNumber","href","URL","createObjectURL","download","className","_c","$RefreshReg$"],"sources":["C:/Users/mesco/OneDrive/Documents/GitHub/S/src/components/DecryptSection.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport ToBits from \"./ToBits\";\r\nimport { decryptData } from \"./ToBlackBox\";\r\n\r\n// Decode message (spatial) from frames\r\nconst decodeSpatial = (frames, messageLength) => {\r\n  let bits = '';\r\n  let count = 0;\r\n  for (const frame of frames) {\r\n    const patch = frame.patch;\r\n    for (let i = 4; i < patch.length; i += 4) { // skip first pixel to avoid temporal\r\n      if (count >= messageLength) break;\r\n      bits += (patch[i + 2] & 1).toString(); // blue channel\r\n      count++;\r\n    }\r\n    if (count >= messageLength) break;\r\n  }\r\n  return bits;\r\n};\r\n\r\n// Decode metadata (temporal) from frames\r\nconst decodeTemporal = (frames, metadataLength) => {\r\n  let bits = '';\r\n  for (let i = 0; i < metadataLength; i++) {\r\n    const frame = frames[i % frames.length]; // loop if needed\r\n    bits += (frame.patch[2] & 1).toString(); // first pixel blue channel\r\n  }\r\n  return bits;\r\n};\r\n\r\n// Convert binary string to string\r\nconst binaryToString = (binaryStr) => {\r\n  let result = '';\r\n  for (let i = 0; i < binaryStr.length; i += 8) {\r\n    result += String.fromCharCode(parseInt(binaryStr.slice(i, i + 8), 2));\r\n  }\r\n  return result;\r\n};\r\n\r\nexport default function DecryptSection({ messageLength, metadataLength, password }) {\r\n  const [frames, setFrames] = useState([]);\r\n  const [file, setFile] = useState(null);\r\n  const [fileName, setFileName] = useState('');\r\n  const [error, setError] = useState(null);\r\n  const [decryptedBlob, setDecryptedBlob] = useState(null);\r\n\r\n  const handleGIFChange = (event) => {\r\n    const file = event.target.files[0];\r\n    if (!file) return;\r\n    if (file.type !== 'image/gif') {\r\n      setError('Please upload a valid GIF file.');\r\n      return;\r\n    }\r\n    setError(null);\r\n    setFile(file);\r\n    setFileName(file.name);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!file || !password) return;\r\n\r\n    ToBits(file)\r\n      .then(async ({ frames: extractedFrames }) => {\r\n        setFrames(extractedFrames);\r\n\r\n        // Decode metadata\r\n        const metadataBits = decodeTemporal(extractedFrames, metadataLength);\r\n        const metadataStr = binaryToString(metadataBits);\r\n        const metadata = JSON.parse(metadataStr);\r\n\r\n        // Decode message\r\n        const messageBits = decodeSpatial(extractedFrames, metadata.originalLength);\r\n\r\n        // Decrypt message\r\n        const encryptedData = new Uint8Array(\r\n          messageBits.match(/.{1,8}/g).map(byte => parseInt(byte, 2))\r\n        );\r\n        const decryptedBinary = await decryptData(encryptedData, password, metadata.iv, metadata.salt);\r\n\r\n        // Convert decrypted binary to Blob\r\n        const bytes = new Uint8Array(\r\n          decryptedBinary.match(/.{1,8}/g).map(byte => parseInt(byte, 2))\r\n        );\r\n        setDecryptedBlob(new Blob([bytes], { type: metadata.fileType, name: metadata.fileName }));\r\n      })\r\n      .catch(err => setError(err.message));\r\n  }, [file, password, metadataLength]);\r\n\r\n  return (\r\n    <div>\r\n      <input type=\"file\" accept=\"image/gif\" onChange={handleGIFChange} />\r\n      {fileName && <p>Uploaded GIF: {fileName}</p>}\r\n\r\n      {decryptedBlob && (\r\n        <div>\r\n          <h2>Decrypted File</h2>\r\n          <a href={URL.createObjectURL(decryptedBlob)} download={decryptedBlob.name}>\r\n            Download {decryptedBlob.name}\r\n          </a>\r\n        </div>\r\n      )}\r\n\r\n      {error && <p className=\"error\">{error}</p>}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}