{"ast":null,"code":"// ToBlackBox.js\n\nexport async function encryptData(data, password) {\n  const enc = new TextEncoder();\n  const keyMaterial = await crypto.subtle.importKey(\"raw\", enc.encode(password), \"PBKDF2\", false, [\"deriveKey\"]);\n  const salt = crypto.getRandomValues(new Uint8Array(16));\n  const key = await crypto.subtle.deriveKey({\n    name: \"PBKDF2\",\n    salt,\n    iterations: 100000,\n    hash: \"SHA-256\"\n  }, keyMaterial, {\n    name: \"AES-GCM\",\n    length: 256\n  }, false, [\"encrypt\", \"decrypt\"]);\n  const iv = crypto.getRandomValues(new Uint8Array(12));\n\n  // ✅ encrypt RAW BYTES\n  const encrypted = await crypto.subtle.encrypt({\n    name: \"AES-GCM\",\n    iv\n  }, key, data);\n  return {\n    encryptedData: new Uint8Array(encrypted),\n    iv,\n    salt\n  };\n}\nexport async function decryptData(encryptedData, password, iv, salt) {\n  const enc = new TextEncoder();\n  const keyMaterial = await window.crypto.subtle.importKey(\"raw\", enc.encode(password), \"PBKDF2\", false, [\"deriveKey\"]);\n  const key = await window.crypto.subtle.deriveKey({\n    name: \"PBKDF2\",\n    salt: salt,\n    iterations: 100000,\n    hash: \"SHA-256\"\n  }, keyMaterial, {\n    name: \"AES-GCM\",\n    length: 256\n  }, false, [\"encrypt\", \"decrypt\"]);\n  const decrypted = await window.crypto.subtle.decrypt({\n    name: \"AES-GCM\",\n    iv: iv\n  }, key, encryptedData);\n  const dec = new TextDecoder();\n  return dec.decode(decrypted);\n}","map":{"version":3,"names":["encryptData","data","password","enc","TextEncoder","keyMaterial","crypto","subtle","importKey","encode","salt","getRandomValues","Uint8Array","key","deriveKey","name","iterations","hash","length","iv","encrypted","encrypt","encryptedData","decryptData","window","decrypted","decrypt","dec","TextDecoder","decode"],"sources":["C:/Users/mesco/OneDrive/Documents/GitHub/S/src/components/ToBlackBox.js"],"sourcesContent":["// ToBlackBox.js\r\n\r\nexport async function encryptData(data, password) {\r\n  const enc = new TextEncoder();\r\n\r\n  const keyMaterial = await crypto.subtle.importKey(\r\n    \"raw\",\r\n    enc.encode(password),\r\n    \"PBKDF2\",\r\n    false,\r\n    [\"deriveKey\"]\r\n  );\r\n\r\n  const salt = crypto.getRandomValues(new Uint8Array(16));\r\n\r\n  const key = await crypto.subtle.deriveKey(\r\n    {\r\n      name: \"PBKDF2\",\r\n      salt,\r\n      iterations: 100000,\r\n      hash: \"SHA-256\",\r\n    },\r\n    keyMaterial,\r\n    { name: \"AES-GCM\", length: 256 },\r\n    false,\r\n    [\"encrypt\", \"decrypt\"]\r\n  );\r\n\r\n  const iv = crypto.getRandomValues(new Uint8Array(12));\r\n\r\n  // ✅ encrypt RAW BYTES\r\n  const encrypted = await crypto.subtle.encrypt(\r\n    { name: \"AES-GCM\", iv },\r\n    key,\r\n    data\r\n  );\r\n\r\n  return {\r\n    encryptedData: new Uint8Array(encrypted),\r\n    iv,\r\n    salt,\r\n  };\r\n}\r\n\r\nexport async function decryptData(encryptedData, password, iv, salt) {\r\n  const enc = new TextEncoder();\r\n  const keyMaterial = await window.crypto.subtle.importKey(\r\n    \"raw\",\r\n    enc.encode(password),\r\n    \"PBKDF2\",\r\n    false,\r\n    [\"deriveKey\"]\r\n  );\r\n\r\n  const key = await window.crypto.subtle.deriveKey(\r\n    {\r\n      name: \"PBKDF2\",\r\n      salt: salt,\r\n      iterations: 100000,\r\n      hash: \"SHA-256\",\r\n    },\r\n    keyMaterial,\r\n    { name: \"AES-GCM\", length: 256 },\r\n    false,\r\n    [\"encrypt\", \"decrypt\"]\r\n  );\r\n\r\n  const decrypted = await window.crypto.subtle.decrypt(\r\n    { name: \"AES-GCM\", iv: iv },\r\n    key,\r\n    encryptedData\r\n  );\r\n\r\n  const dec = new TextDecoder();\r\n  return dec.decode(decrypted);\r\n}"],"mappings":"AAAA;;AAEA,OAAO,eAAeA,WAAWA,CAACC,IAAI,EAAEC,QAAQ,EAAE;EAChD,MAAMC,GAAG,GAAG,IAAIC,WAAW,CAAC,CAAC;EAE7B,MAAMC,WAAW,GAAG,MAAMC,MAAM,CAACC,MAAM,CAACC,SAAS,CAC/C,KAAK,EACLL,GAAG,CAACM,MAAM,CAACP,QAAQ,CAAC,EACpB,QAAQ,EACR,KAAK,EACL,CAAC,WAAW,CACd,CAAC;EAED,MAAMQ,IAAI,GAAGJ,MAAM,CAACK,eAAe,CAAC,IAAIC,UAAU,CAAC,EAAE,CAAC,CAAC;EAEvD,MAAMC,GAAG,GAAG,MAAMP,MAAM,CAACC,MAAM,CAACO,SAAS,CACvC;IACEC,IAAI,EAAE,QAAQ;IACdL,IAAI;IACJM,UAAU,EAAE,MAAM;IAClBC,IAAI,EAAE;EACR,CAAC,EACDZ,WAAW,EACX;IAAEU,IAAI,EAAE,SAAS;IAAEG,MAAM,EAAE;EAAI,CAAC,EAChC,KAAK,EACL,CAAC,SAAS,EAAE,SAAS,CACvB,CAAC;EAED,MAAMC,EAAE,GAAGb,MAAM,CAACK,eAAe,CAAC,IAAIC,UAAU,CAAC,EAAE,CAAC,CAAC;;EAErD;EACA,MAAMQ,SAAS,GAAG,MAAMd,MAAM,CAACC,MAAM,CAACc,OAAO,CAC3C;IAAEN,IAAI,EAAE,SAAS;IAAEI;EAAG,CAAC,EACvBN,GAAG,EACHZ,IACF,CAAC;EAED,OAAO;IACLqB,aAAa,EAAE,IAAIV,UAAU,CAACQ,SAAS,CAAC;IACxCD,EAAE;IACFT;EACF,CAAC;AACH;AAEA,OAAO,eAAea,WAAWA,CAACD,aAAa,EAAEpB,QAAQ,EAAEiB,EAAE,EAAET,IAAI,EAAE;EACnE,MAAMP,GAAG,GAAG,IAAIC,WAAW,CAAC,CAAC;EAC7B,MAAMC,WAAW,GAAG,MAAMmB,MAAM,CAAClB,MAAM,CAACC,MAAM,CAACC,SAAS,CACtD,KAAK,EACLL,GAAG,CAACM,MAAM,CAACP,QAAQ,CAAC,EACpB,QAAQ,EACR,KAAK,EACL,CAAC,WAAW,CACd,CAAC;EAED,MAAMW,GAAG,GAAG,MAAMW,MAAM,CAAClB,MAAM,CAACC,MAAM,CAACO,SAAS,CAC9C;IACEC,IAAI,EAAE,QAAQ;IACdL,IAAI,EAAEA,IAAI;IACVM,UAAU,EAAE,MAAM;IAClBC,IAAI,EAAE;EACR,CAAC,EACDZ,WAAW,EACX;IAAEU,IAAI,EAAE,SAAS;IAAEG,MAAM,EAAE;EAAI,CAAC,EAChC,KAAK,EACL,CAAC,SAAS,EAAE,SAAS,CACvB,CAAC;EAED,MAAMO,SAAS,GAAG,MAAMD,MAAM,CAAClB,MAAM,CAACC,MAAM,CAACmB,OAAO,CAClD;IAAEX,IAAI,EAAE,SAAS;IAAEI,EAAE,EAAEA;EAAG,CAAC,EAC3BN,GAAG,EACHS,aACF,CAAC;EAED,MAAMK,GAAG,GAAG,IAAIC,WAAW,CAAC,CAAC;EAC7B,OAAOD,GAAG,CAACE,MAAM,CAACJ,SAAS,CAAC;AAC9B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}