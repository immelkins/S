{"ast":null,"code":"// ToBinary.js\nimport { encryptData } from \"./ToBlackBox\";\n\n// Convert Uint8Array to bit array\nfunction uint8ArrayToBitArray(bytes) {\n  const bits = [];\n  for (const byte of bytes) {\n    for (let i = 7; i >= 0; i--) {\n      bits.push(byte >> i & 1);\n    }\n  }\n  return bits;\n}\n\n// Convert string to bit array\nfunction stringToBitArray(str) {\n  const bits = [];\n  for (let i = 0; i < str.length; i++) {\n    const byte = str.charCodeAt(i);\n    for (let j = 7; j >= 0; j--) {\n      bits.push(byte >> j & 1);\n    }\n  }\n  return bits;\n}\n\n// Convert number to 32-bit array\nfunction numberTo32BitArray(num) {\n  const bits = [];\n  for (let i = 31; i >= 0; i--) {\n    bits.push(num >> i & 1);\n  }\n  return bits;\n}\n\n// Convert Uint8Array to Base64 string\nfunction uint8ArrayToBase64(uint8Array) {\n  return btoa(String.fromCharCode(...uint8Array));\n}\n\n// ToBinary.js\nexport default async function ToBinary(file, password) {\n  if (!file) throw new Error(\"No file provided\");\n  if (!password || password.trim() === \"\") throw new Error(\"Password is required\");\n  const arrayBuffer = await file.arrayBuffer();\n  const bytes = new Uint8Array(arrayBuffer);\n\n  // Encrypt raw bytes\n  const {\n    encryptedData,\n    iv,\n    salt\n  } = await encryptData(bytes, password);\n\n  // Metadata object\n  const metadata = {\n    iv: uint8ArrayToBase64(iv),\n    salt: uint8ArrayToBase64(salt),\n    originalLength: bytes.length,\n    fileName: file.name,\n    fileType: file.type\n  };\n  console.log(\"Metadata object (inside ToBinary):\", metadata); // ✅ This should print\n\n  // Convert metadata JSON to bits\n  const metadataStr = JSON.stringify(metadata);\n  const metadataBits = stringToBitArray(metadataStr);\n  const lengthBits = numberTo32BitArray(metadataBits.length);\n  const fullMetadataBits = [...lengthBits, ...metadataBits];\n  const payloadBits = uint8ArrayToBitArray(encryptedData);\n  return {\n    bits: payloadBits,\n    metabits: fullMetadataBits\n  };\n}\n_c = ToBinary;\nvar _c;\n$RefreshReg$(_c, \"ToBinary\");","map":{"version":3,"names":["encryptData","uint8ArrayToBitArray","bytes","bits","byte","i","push","stringToBitArray","str","length","charCodeAt","j","numberTo32BitArray","num","uint8ArrayToBase64","uint8Array","btoa","String","fromCharCode","ToBinary","file","password","Error","trim","arrayBuffer","Uint8Array","encryptedData","iv","salt","metadata","originalLength","fileName","name","fileType","type","console","log","metadataStr","JSON","stringify","metadataBits","lengthBits","fullMetadataBits","payloadBits","metabits","_c","$RefreshReg$"],"sources":["C:/Users/mesco/OneDrive/Documents/GitHub/S/src/components/ToBinary.js"],"sourcesContent":["// ToBinary.js\r\nimport { encryptData } from \"./ToBlackBox\";\r\n\r\n// Convert Uint8Array to bit array\r\nfunction uint8ArrayToBitArray(bytes) {\r\n  const bits = [];\r\n  for (const byte of bytes) {\r\n    for (let i = 7; i >= 0; i--) {\r\n      bits.push((byte >> i) & 1);\r\n    }\r\n  }\r\n  return bits;\r\n}\r\n\r\n// Convert string to bit array\r\nfunction stringToBitArray(str) {\r\n  const bits = [];\r\n  for (let i = 0; i < str.length; i++) {\r\n    const byte = str.charCodeAt(i);\r\n    for (let j = 7; j >= 0; j--) {\r\n      bits.push((byte >> j) & 1);\r\n    }\r\n  }\r\n  return bits;\r\n}\r\n\r\n// Convert number to 32-bit array\r\nfunction numberTo32BitArray(num) {\r\n  const bits = [];\r\n  for (let i = 31; i >= 0; i--) {\r\n    bits.push((num >> i) & 1);\r\n  }\r\n  return bits;\r\n}\r\n\r\n// Convert Uint8Array to Base64 string\r\nfunction uint8ArrayToBase64(uint8Array) {\r\n  return btoa(String.fromCharCode(...uint8Array));\r\n}\r\n\r\n// ToBinary.js\r\nexport default async function ToBinary(file, password) {\r\n  if (!file) throw new Error(\"No file provided\");\r\n  if (!password || password.trim() === \"\") throw new Error(\"Password is required\");\r\n\r\n  const arrayBuffer = await file.arrayBuffer();\r\n  const bytes = new Uint8Array(arrayBuffer);\r\n\r\n  // Encrypt raw bytes\r\n  const { encryptedData, iv, salt } = await encryptData(bytes, password);\r\n\r\n  // Metadata object\r\n  const metadata = {\r\n    iv: uint8ArrayToBase64(iv),\r\n    salt: uint8ArrayToBase64(salt),\r\n    originalLength: bytes.length,\r\n    fileName: file.name,\r\n    fileType: file.type\r\n  };\r\n\r\n  console.log(\"Metadata object (inside ToBinary):\", metadata); // ✅ This should print\r\n\r\n  // Convert metadata JSON to bits\r\n  const metadataStr = JSON.stringify(metadata);\r\n  const metadataBits = stringToBitArray(metadataStr);\r\n\r\n  const lengthBits = numberTo32BitArray(metadataBits.length);\r\n  const fullMetadataBits = [...lengthBits, ...metadataBits];\r\n\r\n  const payloadBits = uint8ArrayToBitArray(encryptedData);\r\n\r\n  return {\r\n    bits: payloadBits,\r\n    metabits: fullMetadataBits\r\n  };\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}